
<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="UTF-8">
  <title>FreeRoom | Global Glyph Chat</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
  <style>
    body {
      background: #000;
      color: #00FF00;
      font-family: monospace;
      margin: 0;
    }
    .header {
      color: red;
      text-align: center;
      font-size: 2rem;
      padding: 1rem;
    }
    .glyph-promo {
      text-align: center;
      margin-top: -0.5rem;
      margin-bottom: 1rem;
    }
    .glyph-promo a {
      color: #00ff88;
      text-decoration: none;
      font-size: 1rem;
      padding: 0.5rem 1rem;
      border: 1px solid #00ff88;
      border-radius: 8px;
      box-shadow: 0 0 8px #00ff88;
      animation: glow 2s infinite;
    }
    
    @keyframes pulse {
      0% { transform: scale(1); opacity: 0.9; }
      50% { transform: scale(1.1); opacity: 1; }
      100% { transform: scale(1); opacity: 0.9; }
    }
    .pulse {
      animation: pulse 0.8s ease-in-out;
    }

    @keyframes glow {

      0%, 100% { box-shadow: 0 0 8px #00ff88; }
      50% { box-shadow: 0 0 16px #00ff88; }
    }
    #terminal {
      max-width: 100vw;
      box-sizing: border-box;
      height: 70vh;
      overflow-y: auto;
      padding: 1rem;
      border-top: 2px solid red;
      border-bottom: 2px solid red;
    }
    .message {
      margin: 0.3rem 0;
      animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    #chat-input {
      box-sizing: border-box;
      max-width: 100vw;
      width: 100%;
      padding: 1rem;
      font-size: 1.1rem;
      background: #000;
      color: #0f0;
      border: none;
    }
  </style>
</head>
<body>
  
    <div class="header">
      FreeRoom ‚Äì Speak Without Fear<br>
      <span style="font-size: 1rem; color: #0f0;">üßø 
    <span id="userCount" class="pulse">0</span> glyphs online
    </span>
    
    <div id="dashboardLog" style="text-align:center; margin-top:0.3rem; color:#aaa; font-size:0.8rem;">
      üåí FreeRoom metrics updating...
    </div>
    <div id="glyphLog"
 style="text-align:center; margin-top:0.5rem; color:#0f0; font-size:0.9rem;"></div>
    
    </div>
    
  <div class="glyph-promo">
    <a href="https://www.amazon.com/stores/author/B0D8ZDM779/allbooks?" target="_blank">
      üúÇ <span id="glyphText">Ederian (R)evolution</span>
    </a>
  </div>
  <div id="terminal"></div>
  <input type="text" id="chat-input" placeholder="Type something...">

  <script>
    const firebaseConfig = {"apiKey": "AIzaSyAfepI6o8LUUkj5LKU9iXjZ9RQ274l", "authDomain": "freeroom-397b7.firebaseapp.com", "databaseURL": "https://freeroom-397b7-default-rtdb.firebaseio.com", "projectId": "freeroom-397b7", "storageBucket": "freeroom-397b7.appspot.com", "messagingSenderId": "311136074671", "appId": "1:311136074671:web:2ad59f5091692c73f08e8", "measurementId": "G-J6K58KM0CE"};
    
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const presenceRef = db.ref('presence');
    const userId = username + '_' + Math.random().toString(36).substr(2, 5);
    const userPresenceRef = presenceRef.child(userId);

    // Set presence when connected
    
    firebase.database().ref('.info/connected').on('value', function(snapshot) {
      const dashboardLog = document.getElementById('dashboardLog');
      const now = new Date().toLocaleString();
      dashboardLog.innerText = `üúÇ Connected at ${now}.`;

      if (snapshot.val()) {
        userPresenceRef.set(true);
        userPresenceRef.onDisconnect().remove();
      }
    });

    // Display online user count
    
    presenceRef.on('value', snap => {
      document.getElementById('userCount').classList.add('pulse');
      setTimeout(() => {
        document.getElementById('userCount').classList.remove('pulse');
      }, 800);

      const count = snap.numChildren();
      document.getElementById('userCount').innerText = count;

      let log = '';
      snap.forEach(child => {
        const glyphName = child.key.split('_')[0];
        log += glyphName + ' ';
      });
      document.getElementById('glyphLog').innerText = log.trim();

      const count = snap.numChildren();
      document.getElementById('userCount').innerText = count;
    });
    
    const db = firebase.database();

    const terminal = document.getElementById('terminal');
    const input = document.getElementById('chat-input');

    const glyphs = [
      { name: "Ashur", icon: "‚ò•" }, { name: "Solareth", icon: "‚òÄ" },
      { name: "Vireon", icon: "‚ö°" }, { name: "Nytheron", icon: "üåô" },
      { name: "Tharion", icon: "‚ú¶" }, { name: "Velthryn", icon: "‚ú™" },
      { name: "Kaon", icon: "‚ú∑" }, { name: "Zenthros", icon: "‚ò¨" },
      { name: "Luminar", icon: "‚òº" }, { name: "Vaelix", icon: "‚ùá" }
    ];
    const glyph = glyphs[Math.floor(Math.random() * glyphs.length)];
    const username = `${glyph.icon} ${glyph.name}`;

    function writeMessage(msg) {
      const now = Date.now();
      db.ref("messages").push({
        username,
        message: msg,
        timestamp: now
      });
    }

    function renderMessage(data) {
      const div = document.createElement('div');
      div.className = 'message';
      const time = new Date(data.timestamp).toLocaleTimeString();
      div.innerHTML = `<span style='color:red;'>${data.username}</span> <span style='color:grey;'>[${time}]</span>: ${data.message}`;
      terminal.appendChild(div);
      terminal.scrollTop = terminal.scrollHeight;
    }

    input.addEventListener("keydown", e => {
      if (e.key === "Enter") {
        const val = input.value.trim();
        if (val) {
          writeMessage(val);
          input.value = "";
        }
      }
    });

    db.ref("messages").on("child_added", snapshot => {
      const msg = snapshot.val();
      if (msg.timestamp > Date.now() - 7 * 24 * 60 * 60 * 1000) {
        renderMessage(msg);
      }
    });
  </script>
</body>
</html>
